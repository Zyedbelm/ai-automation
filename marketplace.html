<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Marketplace Blueprints - Baptiste Zyed MEDDEB</title>
    <meta name="description" content="Automatisations Make.com pr√™tes √† l'emploi. Templates experts pour automatiser vos processus m√©tier rapidement.">

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Fraunces:wght@600;700&display=swap" rel="stylesheet">

    <!-- Security Utils -->
    <script src="security-utils.js"></script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #2563eb;
            --primary-dark: #1d4ed8;
            --secondary: #64748b;
            --accent: #f59e0b;
            --success: #059669;
            --white: #ffffff;
            --gray-50: #f8fafc;
            --gray-100: #f1f5f9;
            --gray-900: #0f172a;
            --shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
        }

        body {
            font-family: 'Inter', sans-serif;
            line-height: 1.6;
            color: var(--gray-900);
            background: var(--white);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        /* Navigation */
        nav {
            position: sticky;
            top: 0;
            width: 100%;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--gray-100);
            z-index: 1000;
        }

        .nav-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 2rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        .logo {
            font-family: 'Fraunces', serif;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
            text-decoration: none;
        }

        .nav-links {
            display: flex;
            list-style: none;
            gap: 2rem;
            align-items: center;
        }

        .nav-links a {
            color: var(--secondary);
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s ease;
        }

        .nav-links a:hover {
            color: var(--primary);
        }

        /* Style sp√©cial pour le bouton Blueprints */
        .nav-links a[href*="marketplace"]:not(.nav-cta) {
            border: 2px solid #1e3a8a;
            border-radius: 8px;
            padding: 0.5rem 1rem;
            transition: all 0.3s ease;
        }

        .nav-links a[href*="marketplace"]:hover {
            background-color: #1e3a8a;
            color: white;
            transform: translateY(-1px);
        }

        .nav-cta {
            background: var(--primary);
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .nav-cta:hover {
            background: var(--primary-dark);
        }

        .back-btn {
            background: linear-gradient(135deg, #FF6B00, #FF4500);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .back-btn:hover {
            background: linear-gradient(135deg, #FF4500, #FF2D00);
            transform: translateY(-1px);
        }

        /* Header */
        .marketplace-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 4rem 0;
            text-align: center;
        }

        .marketplace-header h1 {
            font-family: 'Fraunces', serif;
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .marketplace-header p {
            font-size: 1.2rem;
            opacity: 0.9;
            max-width: 600px;
            margin: 0 auto;
        }

        /* Filters */
        .filters-section {
            background: var(--gray-50);
            padding: 2rem 0;
            border-bottom: 1px solid var(--gray-100);
        }

        .filters {
            display: flex;
            gap: 1rem;
            align-items: center;
            flex-wrap: wrap;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .filter-group label {
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--secondary);
        }

        .filter-group input,
        .filter-group select {
            padding: 0.5rem 1rem;
            border: 1px solid var(--gray-100);
            border-radius: 8px;
            background: white;
            font-size: 0.875rem;
        }

        .search-input {
            min-width: 300px;
        }

        /* Blueprint Grid */
        .blueprints-section {
            padding: 3rem 0;
        }

        .blueprints-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 2rem;
        }

        .blueprint-card {
            background: white;
            border-radius: 16px;
            padding: 1.5rem;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--gray-100);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .blueprint-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow);
        }

        .blueprint-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
        }

        .blueprint-category {
            background: var(--primary);
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .blueprint-price {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--primary);
        }

        .blueprint-title {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--gray-900);
        }

        .blueprint-description {
            color: var(--secondary);
            line-height: 1.5;
            margin-bottom: 1.5rem;
        }

        .blueprint-meta {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1.5rem;
            font-size: 0.875rem;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .blueprint-features {
            margin-bottom: 1.5rem;
        }

        .features-title {
            font-size: 0.875rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--gray-900);
        }

        .feature-list {
            list-style: none;
        }

        .feature-list li {
            font-size: 0.875rem;
            color: var(--secondary);
            margin-bottom: 0.25rem;
            padding-left: 1rem;
            position: relative;
        }

        .feature-list li:before {
            content: '‚úì';
            position: absolute;
            left: 0;
            color: var(--success);
            font-weight: 600;
        }

        .blueprint-actions {
            display: flex;
            gap: 0.5rem;
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 600;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            font-size: 0.875rem;
            flex: 1;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-dark);
        }

        .btn-secondary {
            background: var(--gray-100);
            color: var(--gray-900);
        }

        .btn-secondary:hover {
            background: var(--gray-100);
            opacity: 0.8;
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 10000;
            align-items: center;
            justify-content: center;
        }

        .modal.show {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 16px;
            max-width: 800px;
            max-height: 80vh;
            overflow-y: auto;
            margin: 2rem;
            position: relative;
        }

        .modal-header {
            padding: 2rem 2rem 1rem;
            border-bottom: 1px solid var(--gray-100);
            position: sticky;
            top: 0;
            background: white;
            z-index: 1;
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .modal-close {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--secondary);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-close:hover {
            background: var(--gray-100);
        }

        .modal-body {
            padding: 2rem;
        }

        .modal-section {
            margin-bottom: 2rem;
        }

        .modal-section h3 {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: var(--gray-900);
        }

        .installation-steps {
            list-style: none;
            counter-reset: step-counter;
        }

        .installation-steps li {
            counter-increment: step-counter;
            margin-bottom: 1rem;
            padding-left: 3rem;
            position: relative;
            line-height: 1.6;
        }

        .installation-steps li:before {
            content: counter(step-counter);
            position: absolute;
            left: 0;
            top: 0;
            background: var(--primary);
            color: white;
            width: 2rem;
            height: 2rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 0.875rem;
        }

        .modal-footer {
            padding: 1rem 2rem 2rem;
            border-top: 1px solid var(--gray-100);
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
        }

        .purchase-status {
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            text-align: center;
            font-weight: 600;
        }

        .purchase-status.pending {
            background: #fef3c7;
            color: #92400e;
        }

        .purchase-status.success {
            background: #d1fae5;
            color: #065f46;
        }

        .purchase-status.error {
            background: #fee2e2;
            color: #991b1b;
        }

        .download-section {
            background: var(--gray-50);
            padding: 1.5rem;
            border-radius: 12px;
            margin-top: 1rem;
        }

        .download-section.locked {
            opacity: 0.6;
        }

        /* Footer */
        footer {
            background: var(--gray-900);
            color: white;
            padding: 3rem 0 1rem;
        }

        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .footer-section h3 {
            font-weight: 600;
            margin-bottom: 1rem;
        }

        .footer-section a {
            color: #94a3b8;
            text-decoration: none;
            display: block;
            margin-bottom: 0.5rem;
            transition: color 0.3s ease;
        }

        .footer-section a:hover {
            color: white;
        }

        .footer-bottom {
            border-top: 1px solid #374151;
            padding-top: 2rem;
            text-align: center;
            color: #94a3b8;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .marketplace-header h1 {
                font-size: 2rem;
            }

            .filters {
                flex-direction: column;
                align-items: stretch;
            }

            .search-input {
                min-width: auto;
            }

            .blueprints-grid {
                grid-template-columns: 1fr;
            }

            .modal-content {
                margin: 1rem;
                max-height: 90vh;
            }

            .modal-body {
                padding: 1rem;
            }

            .modal-header {
                padding: 1rem;
            }

            .modal-footer {
                padding: 1rem;
            }
        }
    </style>
</head>

<body>
    <!-- Navigation -->
    <nav>
        <div class="nav-container">
            <div style="display: flex; align-items: center; gap: 1rem;">
                <button onclick="goBack()" class="back-btn">
                    ‚Üê RETOUR
                </button>
                <a href="index.html" class="logo">BZM</a>
            </div>
            <ul class="nav-links">
                <li><a href="index.html#calculator">Calculateur</a></li>
                <li><a href="index.html#services">Services</a></li>
                <li><a href="marketplace.html">Blueprints</a></li>
                <li><a href="index.html#testimonials">T√©moignages</a></li>
                <li><a href="index.html#about">√Ä propos</a></li>
                <li><a href="index.html#contact">Contact</a></li>
            </ul>
            <a href="https://calendar.app.google/vaCEdgHuR2Ffdrp3A" class="nav-cta" target="_blank">R√©server un appel</a>
        </div>
    </nav>

    <!-- Header -->
    <header class="marketplace-header">
        <div class="container">
            <h1>üöÄ Blueprints Make.com</h1>
            <p>Automatisations pr√™tes √† l'emploi pour booster votre business. Installation facile, support inclus.</p>
        </div>
    </header>

    <!-- Filters -->
    <section class="filters-section">
        <div class="container">
            <div class="filters">
                <div class="filter-group">
                    <label for="searchInput">Rechercher</label>
                    <input type="text" id="searchInput" class="search-input" placeholder="Chercher un blueprint...">
                </div>

                <div class="filter-group">
                    <label for="categoryFilter">Cat√©gorie</label>
                    <select id="categoryFilter">
                        <option value="">Toutes les cat√©gories</option>
                        <option value="Lead Generation">Lead Generation</option>
                        <option value="Social Media">Social Media</option>
                        <option value="E-commerce">E-commerce</option>
                        <option value="CRM & Sales">CRM & Sales</option>
                        <option value="Marketing">Marketing</option>
                        <option value="Analytics">Analytics</option>
                    </select>
                </div>

                <div class="filter-group">
                    <label for="priceFilter">Prix</label>
                    <select id="priceFilter">
                        <option value="">Tous les prix</option>
                        <option value="0-50">0 - 50‚Ç¨</option>
                        <option value="50-100">50 - 100‚Ç¨</option>
                        <option value="100+">100‚Ç¨+</option>
                    </select>
                </div>

                <div class="filter-group">
                    <label for="difficultyFilter">Difficult√©</label>
                    <select id="difficultyFilter">
                        <option value="">Toutes</option>
                        <option value="D√©butant">D√©butant</option>
                        <option value="Interm√©diaire">Interm√©diaire</option>
                        <option value="Avanc√©">Avanc√©</option>
                    </select>
                </div>
            </div>
        </div>
    </section>

    <!-- Blueprints Grid -->
    <section class="blueprints-section">
        <div class="container">
            <div id="blueprintsGrid" class="blueprints-grid">
                <!-- Blueprints will be loaded here -->
            </div>
        </div>
    </section>

    <!-- Blueprint Modal -->
    <div id="blueprintModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="modalTitle">Blueprint Details</h2>
                <button class="modal-close" onclick="closeModal()">&times;</button>
            </div>

            <div class="modal-body">
                <div id="purchaseStatus" class="purchase-status" style="display: none;"></div>

                <div class="modal-section">
                    <h3>üìã Aper√ßu du Blueprint</h3>
                    <div id="modalDescription"></div>
                    <div id="modalFeatures"></div>
                </div>

                <div class="modal-section">
                    <h3>üîß Guide d'Installation</h3>
                    <div id="modalInstallation"></div>
                </div>

                <div class="modal-section">
                    <h3>üí° Pr√©requis Techniques</h3>
                    <div id="modalPrerequisites"></div>
                </div>

                <div class="download-section" id="downloadSection">
                    <h3>üí≥ Processus d'achat</h3>
                    <div style="background: #f0f7ff; border: 1px solid #bfdbfe; border-radius: 8px; padding: 1rem; margin-bottom: 1rem;">
                        <h4 style="color: #1e40af; margin-bottom: 0.5rem;">üöÄ Achat simplifi√© en 3 √©tapes :</h4>
                        <ol style="color: #374151; margin-left: 1.5rem; line-height: 1.6;">
                            <li>Cliquez sur "Acheter sur Gumroad" ci-dessous</li>
                            <li>Compl√©tez le paiement s√©curis√© sur Gumroad</li>
                            <li>Apr√®s paiement, vous serez redirig√© vers une page avec un bouton de t√©l√©chargement direct</li>
                        </ol>
                        <p style="color: #6b7280; font-size: 0.875rem; margin-top: 0.5rem;">
                            ‚úÖ T√©l√©chargement imm√©diat ‚Ä¢ üìß Re√ßu par email ‚Ä¢ üîí Paiement s√©curis√©
                        </p>
                    </div>
                </div>
            </div>

            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal()">Fermer</button>
                <button class="btn btn-primary" id="purchaseBtn">
                    üõí Acheter sur Gumroad - <span id="modalPrice">0</span>‚Ç¨
                </button>
            </div>
        </div>
    </div>

    <script>
        // Configuration
        const API_URL = 'http://localhost:3001';

        let allBlueprints = [];
        let filteredBlueprints = [];
        let currentBlueprint = null;
        let purchases = new Set(); // Track purchased blueprints

        // Sample blueprint data (loaded from admin or API)
        const sampleBlueprints = [
            {
                id: 'test-blueprint-1euro',
                name: 'test-blueprint-simple',
                title: 'üß™ Blueprint Test - 1 Franc',
                description: 'Blueprint de test pour valider le processus d\'achat et de t√©l√©chargement - Prix symbolique de 1 franc',
                long_description: 'Ce blueprint de test vous permet de tester enti√®rement le processus d\'achat : clic sur achat, redirection vers Gumroad, et t√©l√©chargement du fichier JSON. Parfait pour v√©rifier que tout fonctionne avant d\'acheter un blueprint plus co√ªteux. Contient un workflow Make.com simple avec webhook et transformation JSON.',
                price: 100, // 1‚Ç¨
                currency: 'eur',
                category: 'Analytics',
                difficulty_level: 'D√©butant',
                estimated_setup_time: '5-10 minutes',
                gumroad_url: 'https://baptistezm.gumroad.com/l/test-blueprint',
                features: [
                    'Workflow Make.com simple √† importer',
                    'Webhook configur√© pour tests',
                    'Transformation JSON basique',
                    'Guide d\'installation simplifi√©',
                    'Perfect pour tester le syst√®me d\'achat'
                ],
                prerequisites: [
                    'Compte Make.com (gratuit suffisant)',
                    'Aucune API externe requise'
                ],
                installation_steps: [
                    'üöÄ Import simple : Se connecter √† Make.com et importer le fichier JSON t√©l√©charg√©',
                    'üîó Test du webhook : Copier l\'URL de webhook g√©n√©r√©e et tester avec une requ√™te simple',
                    '‚úÖ Validation : V√©rifier que les donn√©es JSON sont bien trait√©es dans Make.com'
                ]
            },
            {
                id: 'expense-ocr-automation',
                name: 'expense-ocr-mailhook',
                title: 'Lecteur Automatique de Notes de Frais par Email',
                description: 'Automatisation compl√®te : r√©ception email ‚Üí OCR intelligent ‚Üí extraction donn√©es ‚Üí enregistrement comptable automatique',
                long_description: 'Ce blueprint r√©volutionnaire transforme la gestion de vos notes de frais en un processus 100% automatis√©. D√®s qu\'une photo de ticket ou facture arrive par email (via mailhook), le syst√®me utilise l\'OCR avanc√© pour extraire automatiquement toutes les informations : montant, date, TVA, cat√©gorie, fournisseur. Les donn√©es sont ensuite class√©es intelligemment et int√©gr√©es directement dans votre logiciel comptable (Xero, QuickBooks) ou votre CRM avec validation automatique des r√®gles fiscales.',
                price: 14700, // 147‚Ç¨
                currency: 'eur',
                category: 'Analytics',
                difficulty_level: 'Avanc√©',
                estimated_setup_time: '90-120 minutes',
                gumroad_url: 'https://baptistezm.gumroad.com/l/expense-ocr-automation',
                features: [
                    'R√©ception automatique par email (mailhook)',
                    'OCR intelligent multi-langue (Fran√ßais, Anglais, Allemand)',
                    'Extraction automatique : montant, date, TVA, fournisseur',
                    'Classification intelligente par cat√©gorie comptable',
                    'Validation des r√®gles fiscales suisses/fran√ßaises',
                    'Int√©gration directe Xero, QuickBooks, Sage',
                    'D√©tection et pr√©vention des doublons',
                    'Notifications Slack/Teams en cas d\'anomalie',
                    'Archivage automatique des justificatifs',
                    'Rapports mensuels de d√©penses par cat√©gorie',
                    'Alertes d√©passement budget',
                    'Export automatique pour expert-comptable'
                ],
                prerequisites: [
                    'Compte Make.com Pro (minimum 10 000 op√©rations/mois)',
                    'Logiciel comptable avec API (Xero recommand√©)',
                    'Adresse email d√©di√©e pour les tickets',
                    'Compte Google Drive ou Dropbox pour archivage',
                    'API OCR (Google Vision ou AWS Textract)',
                    'Slack ou Teams pour notifications (optionnel)'
                ],
                installation_steps: [
                    'üìß Configuration du mailhook : Cr√©er une adresse email d√©di√©e et connecter le webhook Make.com pour intercepter tous les emails entrants avec pi√®ces jointes',
                    'üîç Configuration OCR : Connecter l\'API Google Vision ou AWS Textract, configurer la reconnaissance multi-langue et d√©finir les templates d\'extraction pour diff√©rents types de documents',
                    'üè∑Ô∏è Param√©trage des r√®gles m√©tier : D√©finir les cat√©gories comptables, configurer les r√®gles de validation TVA, param√©trer les seuils d\'alerte et les r√®gles de classification automatique',
                    'üíº Int√©gration comptable : Connecter votre logiciel comptable (Xero/QuickBooks), mapper les comptes comptables, configurer les codes TVA et tester la cr√©ation automatique d\'√©critures',
                    'üîÑ Tests et validation : Tester avec diff√©rents types de tickets (restaurant, taxi, carburant, fournitures), v√©rifier la pr√©cision de l\'OCR, valider les int√©grations et ajuster les r√®gles si n√©cessaire',
                    'üìä Configuration des rapports : Param√©trer les rapports automatiques, configurer les notifications d\'anomalies et mettre en place le syst√®me d\'archivage automatique',
                    'üöÄ Mise en production : Activer le workflow, former les utilisateurs √† l\'envoi par email et mettre en place le suivi des performances'
                ]
            },
            {
                id: 'email-ai-assistant',
                name: 'email-ai-notion-manager',
                title: 'Assistant IA pour Emails : Analyse, R√©ponse et Classement Notion',
                description: 'IA avanc√©e qui lit, analyse, classe vos emails et propose des r√©ponses personnalis√©es avec organisation automatique dans Notion',
                long_description: 'Cet assistant IA r√©volutionnaire transforme votre gestion d\'emails en une exp√©rience fluide et intelligente. Le syst√®me analyse automatiquement chaque email entrant, d√©termine le sentiment, l\'urgence et la cat√©gorie, puis propose une r√©ponse personnalis√©e adapt√©e au contexte. Tous les √©changes sont automatiquement organis√©s dans Notion avec un syst√®me de tags intelligent, un suivi des conversations et une base de connaissance qui s\'enrichit avec chaque interaction. L\'IA apprend de vos habitudes de r√©ponse pour am√©liorer continuellement ses suggestions.',
                price: 11900, // 119‚Ç¨
                currency: 'eur',
                category: 'CRM & Sales',
                difficulty_level: 'Interm√©diaire',
                estimated_setup_time: '60-75 minutes',
                gumroad_url: 'https://baptistezm.gumroad.com/l/email-ai-assistant',
                features: [
                    'Analyse IA avanc√©e : sentiment, urgence, intention',
                    'Classification automatique par cat√©gorie (vente, support, admin)',
                    'G√©n√©ration de r√©ponses personnalis√©es avec OpenAI GPT-4',
                    'Organisation automatique dans Notion avec tags intelligents',
                    'D√©tection des emails prioritaires et VIP',
                    'Base de connaissance √©volutive dans Notion',
                    'Suivi des conversations et historique complet',
                    'R√©ponses automatiques pour emails fr√©quents',
                    'Escalade automatique selon l\'urgence',
                    'R√©sum√©s quotidiens des interactions importantes',
                    'Templates de r√©ponse adaptatifs selon le profil',
                    'Int√©gration calendrier pour prise de RDV automatique'
                ],
                prerequisites: [
                    'Compte Make.com Standard ou Pro',
                    'Compte OpenAI avec acc√®s GPT-4',
                    'Workspace Notion avec API activ√©e',
                    'Gmail ou Outlook avec API access',
                    'Compte Google Calendar (pour RDV automatiques)',
                    'Base de donn√©es Notion pr√©-configur√©e (fournie)'
                ],
                installation_steps: [
                    'üì® Configuration email : Connecter Gmail/Outlook √† Make.com, configurer les triggers pour nouveaux emails, param√©trer les filtres d\'exclusion (newsletters, spam) et d√©finir les comptes prioritaires',
                    'ü§ñ Int√©gration OpenAI : Connecter l\'API OpenAI GPT-4, configurer les prompts d\'analyse (sentiment, urgence, cat√©gorie), param√©trer les templates de r√©ponse et ajuster les param√®tres de cr√©ativit√©',
                    'üìö Configuration Notion : Importer la base de donn√©es fournie, connecter l\'API Notion, configurer les propri√©t√©s personnalis√©es et param√©trer le syst√®me de tags automatiques',
                    'üéØ Param√©trage des r√®gles : D√©finir les crit√®res de priorit√©, configurer les r√®gles de classification, param√©trer les seuils d\'urgence et cr√©er les templates de r√©ponse par cat√©gorie',
                    'üîÑ Tests d\'analyse : Tester l\'analyse IA sur diff√©rents types d\'emails, valider la pr√©cision des classifications, ajuster les prompts et v√©rifier l\'int√©gration Notion',
                    '‚ú® Optimisation des r√©ponses : Tester la g√©n√©ration de r√©ponses, ajuster les templates selon votre style, configurer l\'apprentissage adaptatif et valider la coh√©rence du ton',
                    'üöÄ Activation compl√®te : Activer tous les workflows, configurer les notifications d\'escalade et former √† l\'utilisation du dashboard Notion'
                ]
            },
            {
                id: 'content-creation-ai',
                name: 'instagram-content-ai-replicate',
                title: 'Studio IA : Cr√©ation Compl√®te de Contenu Instagram (Texte + Image + Vid√©o)',
                description: 'Workflow IA complet qui g√©n√®re automatiquement du contenu Instagram professionnel : posts, stories, reels avec Replicate, Midjourney et GPT-4',
                long_description: 'Ce studio de cr√©ation IA r√©volutionnaire automatise enti√®rement votre pr√©sence Instagram. √Ä partir d\'un simple brief ou mot-cl√©, le syst√®me g√©n√®re automatiquement des posts captivants avec GPT-4, cr√©e des visuels √©poustouflants avec Midjourney/Replicate, produit des vid√©os dynamiques avec des mod√®les IA avanc√©s et programme la publication optimale. Le workflow inclut une analyse des tendances, l\'adaptation du contenu √† votre audience, la g√©n√©ration de hashtags pertinents et un syst√®me de validation avant publication. Parfait pour entrepreneurs, agences et cr√©ateurs qui veulent maintenir une pr√©sence Instagram professionnelle sans y passer des heures.',
                price: 19700, // 197‚Ç¨
                currency: 'eur',
                category: 'Content Creation',
                difficulty_level: 'D√©butant',
                estimated_setup_time: '45-60 minutes',
                gumroad_url: 'https://baptistezm.gumroad.com/l/content-creation-ai',
                features: [
                    'G√©n√©ration de posts Instagram avec GPT-4 (captions engageantes)',
                    'Cr√©ation d\'images avec Midjourney/Replicate (styles personnalis√©s)',
                    'Production de vid√©os courtes avec Runway ML/Pika Labs',
                    'G√©n√©ration automatique de hashtags tendance et pertinents',
                    'Planification intelligente selon l\'audience (meilleurs horaires)',
                    'Adaptation du contenu selon les performances pass√©es',
                    'Cr√©ation de stories interactives (sondages, questions)',
                    'G√©n√©ration de carrousels √©ducatifs automatis√©s',
                    'Analyse des tendances et adaptation du contenu',
                    'Templates personnalis√©s selon votre marque (couleurs, fonts)',
                    'Syst√®me de validation avant publication',
                    'Rapports de performance et optimisation continue'
                ],
                prerequisites: [
                    'Compte Make.com Standard (5000 op√©rations/mois suffisent)',
                    'Compte OpenAI avec acc√®s GPT-4',
                    'Compte Replicate ou Midjourney pour g√©n√©ration d\'images',
                    'Compte Instagram Business avec API access',
                    'Compte Meta Business (pour programmer les publications)',
                    'Compte Google Drive pour stockage des m√©dias',
                    'Budget IA estim√© : 20-40‚Ç¨/mois selon volume'
                ],
                installation_steps: [
                    'üé® Configuration des outils IA : Connecter OpenAI GPT-4 pour la r√©daction, configurer Replicate/Midjourney pour les images, param√©trer Runway ML pour les vid√©os et d√©finir vos styles visuels personnalis√©s',
                    'üì± Int√©gration Instagram : Connecter Instagram Business API, configurer Meta Business Manager, param√©trer les autorisations de publication et tester la connexion avec un post simple',
                    '‚öôÔ∏è Param√©trage du workflow : Configurer les d√©clencheurs (planification quotidienne/hebdomadaire), d√©finir vos th√©matiques de contenu, param√©trer les templates de posts et cr√©er la logique de g√©n√©ration automatique',
                    'üéØ Personnalisation de la marque : D√©finir votre palette de couleurs, uploader vos logos et √©l√©ments graphiques, configurer les styles d\'images et param√©trer la tonalit√© de vos textes',
                    'üìä Configuration analytique : Connecter les APIs d\'analyse Instagram, param√©trer le tracking des performances, d√©finir les KPIs importants et configurer les rapports automatiques',
                    'üß™ Tests et optimisation : G√©n√©rer du contenu de test, valider la qualit√© des images/vid√©os, tester les publications programm√©es et ajuster les param√®tres selon les r√©sultats',
                    'üöÄ Lancement et monitoring : Activer la g√©n√©ration automatique, configurer les notifications de contr√¥le qualit√© et mettre en place le syst√®me de monitoring des performances'
                ]
            }
        ];

        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            loadBlueprints();
            setupFilters();
        });

        // Load blueprints
        async function loadBlueprints() {
            try {
                console.log('üîÑ Loading blueprints from API...');
                const response = await fetch('/api/blueprints');
                const data = await response.json();

                if (data.success && data.blueprints) {
                    allBlueprints = data.blueprints;
                    console.log('‚úÖ Blueprints loaded:', allBlueprints.length);
                } else {
                    console.warn('‚ö†Ô∏è API response not successful, using sample data');
                    allBlueprints = sampleBlueprints;
                }

                filteredBlueprints = [...allBlueprints];
                renderBlueprints();
            } catch (error) {
                console.error('‚ùå Error loading blueprints from API:', error);
                console.log('üîÑ Fallback to sample data');
                allBlueprints = sampleBlueprints;
                filteredBlueprints = [...allBlueprints];
                renderBlueprints();
            }
        }

        // Setup filters
        function setupFilters() {
            const searchInput = document.getElementById('searchInput');
            const categoryFilter = document.getElementById('categoryFilter');
            const priceFilter = document.getElementById('priceFilter');
            const difficultyFilter = document.getElementById('difficultyFilter');

            [searchInput, categoryFilter, priceFilter, difficultyFilter].forEach(element => {
                element.addEventListener('change', filterBlueprints);
                element.addEventListener('input', filterBlueprints);
            });
        }

        // Filter blueprints
        function filterBlueprints() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const categoryValue = document.getElementById('categoryFilter').value;
            const priceRange = document.getElementById('priceFilter').value;
            const difficulty = document.getElementById('difficultyFilter').value;

            filteredBlueprints = allBlueprints.filter(blueprint => {
                const matchesSearch = !searchTerm ||
                    blueprint.title.toLowerCase().includes(searchTerm) ||
                    blueprint.description.toLowerCase().includes(searchTerm) ||
                    blueprint.features.some(feature => feature.toLowerCase().includes(searchTerm));

                const matchesCategory = !categoryValue || blueprint.category === categoryValue;

                let matchesPrice = true;
                if (priceRange) {
                    const price = blueprint.price / 100;
                    if (priceRange === '0-50') matchesPrice = price < 50;
                    else if (priceRange === '50-100') matchesPrice = price >= 50 && price <= 100;
                    else if (priceRange === '100+') matchesPrice = price > 100;
                }

                const matchesDifficulty = !difficulty || blueprint.difficulty_level === difficulty;

                return matchesSearch && matchesCategory && matchesPrice && matchesDifficulty;
            });

            renderBlueprints();
        }

        // Render blueprints
        function renderBlueprints() {
            const grid = document.getElementById('blueprintsGrid');

            if (filteredBlueprints.length === 0) {
                grid.innerHTML = ''; // Clear
                const emptyDiv = document.createElement('div');
                emptyDiv.style.cssText = 'grid-column: 1/-1; text-align: center; padding: 3rem;';

                const emptyTitle = SecurityUtils.createSafeElement('h3', 'Aucun blueprint trouv√©');
                const emptyText = SecurityUtils.createSafeElement('p', 'Essayez de modifier vos filtres de recherche.');

                emptyDiv.appendChild(emptyTitle);
                emptyDiv.appendChild(emptyText);
                grid.appendChild(emptyDiv);
                return;
            }

            // Utilisation de la fonction s√©curis√©e pour cr√©er chaque carte
            grid.innerHTML = ''; // Clear
            filteredBlueprints.forEach(blueprint => {
                const card = SecurityUtils.createBlueprintCard(blueprint, formatPrice);
                grid.appendChild(card);
            });
        }

        // Open modal
        function openModal(blueprintId) {
            console.log('üîç Opening modal for:', blueprintId);
            console.log('üìã Available blueprints:', allBlueprints.map(b => b.id));
            // Debug: openModal called

            currentBlueprint = allBlueprints.find(b => b.id === blueprintId);
            if (!currentBlueprint) {
                console.error('‚ùå Blueprint not found:', blueprintId);
                alert('Blueprint non trouv√©: ' + blueprintId);
                return;
            }
            console.log('‚úÖ Blueprint found:', currentBlueprint.title);

            // Populate modal content
            document.getElementById('modalTitle').textContent = currentBlueprint.title;
            // Description s√©curis√©e
            const modalDesc = document.getElementById('modalDescription');
            modalDesc.innerHTML = ''; // Clear

            const descP = SecurityUtils.createSafeElement('p', currentBlueprint.long_description, {'style': 'margin-bottom: 1rem;'});
            modalDesc.appendChild(descP);

            const metaDiv = SecurityUtils.createSafeElement('div', '', {'style': 'display: flex; gap: 2rem; margin-bottom: 1rem;'});
            metaDiv.appendChild(SecurityUtils.createSafeElement('div', `Cat√©gorie: ${currentBlueprint.category}`));
            metaDiv.appendChild(SecurityUtils.createSafeElement('div', `Difficult√©: ${currentBlueprint.difficulty_level}`));
            metaDiv.appendChild(SecurityUtils.createSafeElement('div', `Temps d'installation: ${currentBlueprint.estimated_setup_time}`));
            modalDesc.appendChild(metaDiv);

            // Features s√©curis√©es
            const modalFeatures = document.getElementById('modalFeatures');
            modalFeatures.innerHTML = ''; // Clear

            const featuresTitle = SecurityUtils.createSafeElement('div', 'Toutes les fonctionnalit√©s :', {
                'class': 'features-title',
                'style': 'margin-top: 1rem;'
            });
            modalFeatures.appendChild(featuresTitle);

            const featuresList = SecurityUtils.createSafeList(currentBlueprint.features, 'ul', 'feature-list');
            modalFeatures.appendChild(featuresList);

            // Installation steps s√©curis√©es
            const modalInstallation = document.getElementById('modalInstallation');
            modalInstallation.innerHTML = ''; // Clear

            const installationList = SecurityUtils.createSafeList(currentBlueprint.installation_steps, 'ol', 'installation-steps');
            modalInstallation.appendChild(installationList);

            // Prerequisites s√©curis√©es
            const modalPrerequisites = document.getElementById('modalPrerequisites');
            modalPrerequisites.innerHTML = ''; // Clear

            const prerequisitesList = SecurityUtils.createSafeList(currentBlueprint.prerequisites, 'ul', 'feature-list');
            modalPrerequisites.appendChild(prerequisitesList);

            // S'assurer que le modal est affich√© d'abord
            document.getElementById('blueprintModal').classList.add('show');

            // Attendre un petit d√©lai pour que le DOM soit mis √† jour
            setTimeout(() => {
                const modalPriceElement = document.getElementById('modalPrice');
                if (modalPriceElement) {
                    modalPriceElement.textContent = formatPrice(currentBlueprint.price);
                } else {
                    console.error('‚ùå Element modalPrice not found in DOM');
                }
            }, 100);

            // Setup purchase button
            const purchaseBtn = document.getElementById('purchaseBtn');
            const downloadSection = document.getElementById('downloadSection');

            if (!purchaseBtn) {
                console.error('‚ùå Element purchaseBtn not found in DOM');
                return;
            }

            if (purchases.has(blueprintId)) {
                purchaseBtn.textContent = 'D√©j√† achet√© ‚úì';
                purchaseBtn.disabled = true;
                if (downloadSection) downloadSection.classList.remove('locked');
            } else {
                purchaseBtn.textContent = `Acheter maintenant - ${formatPrice(currentBlueprint.price)}‚Ç¨`;
                purchaseBtn.disabled = false;
                purchaseBtn.onclick = () => purchaseBlueprint(blueprintId);
                if (downloadSection) downloadSection.classList.add('locked');
            }
        }

        // Close modal
        function closeModal() {
            document.getElementById('blueprintModal').classList.remove('show');
            document.getElementById('purchaseStatus').style.display = 'none';
            currentBlueprint = null;
        }

        // Purchase blueprint - redirect to Gumroad
        function purchaseBlueprint(blueprintId) {
            console.log('üõí Starting purchase for:', blueprintId);

            const blueprint = allBlueprints.find(b => b.id === blueprintId);
            if (!blueprint) {
                console.error('‚ùå Blueprint not found for purchase:', blueprintId);
                alert('Blueprint non trouv√©: ' + blueprintId);
                return;
            }

            console.log('‚úÖ Blueprint found for purchase:', blueprint.title);

            // Check if Gumroad URL exists
            if (!blueprint.gumroad_url) {
                alert('‚ùå URL Gumroad manquante pour ce blueprint');
                return;
            }

            // Redirect to Gumroad
            console.log('üîÑ Redirecting to Gumroad:', blueprint.gumroad_url);
            window.open(blueprint.gumroad_url, '_blank');
        }

        // Go back function
        function goBack() {
            if (document.referrer && document.referrer !== window.location.href) {
                window.history.back();
            } else {
                // Fallback to homepage
                window.location.href = 'index.html';
            }
        }

        // Download blueprint
        function downloadBlueprint(blueprintId) {
            if (!purchases.has(blueprintId)) {
                alert('Vous devez d\'abord acheter ce blueprint.');
                return;
            }

            // Create sample JSON file for download
            const blueprint = allBlueprints.find(b => b.id === blueprintId);
            const sampleData = {
                name: blueprint.name,
                version: "1.0.0",
                description: blueprint.description,
                make_scenario: {
                    modules: [
                        {
                            id: 1,
                            name: "Webhook",
                            type: "webhook",
                            parameters: {
                                url: "YOUR_WEBHOOK_URL"
                            }
                        },
                        {
                            id: 2,
                            name: "Data Processing",
                            type: "data_transformer",
                            parameters: {
                                mapping: "Custom mapping rules"
                            }
                        }
                    ],
                    connections: [
                        { from: 1, to: 2 }
                    ]
                },
                installation_guide: blueprint.installation_steps,
                prerequisites: blueprint.prerequisites
            };

            // Create and download file
            const dataStr = JSON.stringify(sampleData, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);

            const exportFileDefaultName = `${blueprint.name}-blueprint.json`;

            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileDefaultName);
            linkElement.click();

            alert('T√©l√©chargement commenc√© ! Le fichier JSON du blueprint va se t√©l√©charger.');
        }

        // Format price
        function formatPrice(price) {
            // Prices are already in euros from the API
            return price;
        }

        // Close modal when clicking outside
        document.getElementById('blueprintModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });

        // Go back function
        function goBack() {
            if (document.referrer && document.referrer !== window.location.href) {
                window.history.back();
            } else {
                window.location.href = 'index.html';
            }
        }
    </script>




    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>Baptiste Zyed MEDDEB</h3>
                    <p>Expert en automatisation des processus m√©tier avec l'Intelligence Artificielle. Bas√© en Suisse.</p>
                    <div style="margin-top: 1rem;">
                        <a href="https://bento.me/bzmeddeb" target="_blank" style="display: block; margin-bottom: 0.5rem;">Mon profil complet >></a>
                        <a href="https://www.linkedin.com/in/bzmeddeb/" target="_blank" style="display: inline-flex; align-items: center; justify-content: center; width: 40px; height: 40px; background: #0077b5; border-radius: 8px; color: white; text-decoration: none; transition: all 0.3s ease;" onmouseover="this.style.background='#005885'" onmouseout="this.style.background='#0077b5'">
                            <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
                            </svg>
                        </a>
                    </div>
                </div>

                <div class="footer-section">
                    <h3>Services</h3>
                    <a href="index.html#services">Audit Personnalis√©</a>
                    <a href="index.html#services">Programme Quick Win</a>
                    <a href="index.html#services">Transformation Compl√®te</a>
                    <a href="https://calendar.app.google/vaCEdgHuR2Ffdrp3A" target="_blank">Consultation Gratuite</a>
                </div>

                <div class="footer-section">
                    <h3>Solutions</h3>
                    <a href="index.html#calculator">Calculateur d'√©conomies</a>
                    <a href="marketplace.html">Blueprints Make.com</a>
                    <a href="faq.html">FAQ</a>
                    <p>R√©daction automatique</p>
                    <p>Gestion des emails</p>
                    <p>Workflows automatis√©s</p>
                </div>

                <div class="footer-section">
                    <h3>Contact</h3>
                    <a href="tel:+41793017915">+41 79 301 79 15</a>
                    <a href="mailto:zyed.elmeddeb@gmail.com">zyed.elmeddeb@gmail.com</a>
                    <p>Route du Man√®ge 60, 1950 Sion</p>
                </div>

            </div>

            <div class="footer-bottom">
                <p>&copy; 2025 Baptiste Zyed MEDDEB - Expert Automatisation IA. Tous droits r√©serv√©s.</p>
            </div>
        </div>
    </footer>
</body>
</html>